
## 13. Trazabilidad, Auditoría y Cumplimiento

### 13.1 Logrotate

**Finalidad:** administrar la rotación y compresión de logs para evitar que llenen el disco.

Archivo de configuración principal:

```
/etc/logrotate.conf
```

Ejemplo de configuración personalizada:

```
/var/log/httpd/*.log {
    weekly
    rotate 4
    compress
    missingok
    notifempty
}
```

Forzar rotación manual:

```bash
logrotate -f /etc/logrotate.conf
```

---

### 13.2 Auditd

**Finalidad:** servicio de auditoría que registra cambios críticos en el sistema.

```bash
systemctl enable auditd
systemctl start auditd
```

#### Monitorear archivo sensible

```bash
auditctl -w /etc/passwd -p wa -k passwd_changes
```

**Descripción:** crea una regla para registrar escrituras y atributos modificados en `/etc/passwd`.

#### Ver reporte por clave

```bash
aureport -k
```

**Interpretación:** muestra los eventos asociados con la clave `passwd_changes`.
